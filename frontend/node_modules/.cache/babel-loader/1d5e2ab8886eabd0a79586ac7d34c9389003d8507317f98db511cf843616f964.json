{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{Input,Typography,Spin,message}from'antd';import{UserOutlined,RobotOutlined,SendOutlined}from'@ant-design/icons';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Text}=Typography;const QAPage=()=>{const[inputValue,setInputValue]=useState('');const[messages,setMessages]=useState([]);const[isLoading,setIsLoading]=useState(false);const messagesEndRef=useRef(null);// Auto-scroll to bottom when messages change\nuseEffect(()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});},[messages]);const handleSend=async()=>{if(!inputValue.trim()||isLoading)return;const question=inputValue;setInputValue('');// Add user question\nsetMessages(prev=>[...prev,{type:'question',content:question},{type:'answer',content:'',loading:true}]);setIsLoading(true);try{// 1. First ensure documents are indexed\nawait axios.post('http://localhost:8000/index');// 2. Get answer from FastAPI backend\nconst response=await axios.post('http://localhost:8000/ask',{question:question});// Update the last message with the actual answer\nsetMessages(prev=>{const newMessages=[...prev];newMessages[newMessages.length-1]={type:'answer',content:response.data.answer||\"Sorry, I couldn't find an answer.\",loading:false};return newMessages;});}catch(error){message.error('Failed to get answer');setMessages(prev=>{const newMessages=[...prev];newMessages[newMessages.length-1]={type:'answer',content:\"Error: Couldn't connect to the AI service\",loading:false};return newMessages;});}finally{setIsLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'24px',height:'100%',display:'flex',flexDirection:'column'},children:[/*#__PURE__*/_jsx(Typography.Title,{level:3,children:\"\\uD83D\\uDC1C Chat with Document\"}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1,overflowY:'auto',marginBottom:'16px',paddingRight:'8px'},children:[messages.map((msg,index)=>/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',alignItems:msg.type==='question'?'flex-start':'flex-start',marginBottom:16},children:/*#__PURE__*/_jsx(\"div\",{style:{border:'1px solid #d9d9d9',borderRadius:8,padding:'12px 16px',backgroundColor:msg.type==='question'?'#f5f5f5':'#e6f7ff',width:'fit-content',maxWidth:'80%'},children:msg.loading?/*#__PURE__*/_jsx(Spin,{size:\"small\"}):/*#__PURE__*/_jsxs(Text,{children:[msg.type==='question'?/*#__PURE__*/_jsx(UserOutlined,{style:{color:'#1890ff'}}):/*#__PURE__*/_jsx(RobotOutlined,{style:{color:'#52c41a'}}),/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:8},children:msg.content})]})})},index)),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(Input,{value:inputValue,onChange:e=>setInputValue(e.target.value),onPressEnter:handleSend,placeholder:\"Ask a question about your documents...\",disabled:isLoading,style:{flex:1}}),/*#__PURE__*/_jsx(SendOutlined,{onClick:handleSend,style:{fontSize:22,color:isLoading?'#d9d9d9':'#1890ff',cursor:isLoading?'not-allowed':'pointer',transform:'rotate(-45deg)',transition:'all 0.2s'},onMouseEnter:e=>!isLoading&&(e.currentTarget.style.transform='scale(1.2) rotate(-45deg)'),onMouseLeave:e=>e.currentTarget.style.transform='rotate(-45deg)'})]})]});};export default QAPage;","map":{"version":3,"names":["React","useState","useRef","useEffect","Input","Typography","Spin","message","UserOutlined","RobotOutlined","SendOutlined","axios","jsx","_jsx","jsxs","_jsxs","Text","QAPage","inputValue","setInputValue","messages","setMessages","isLoading","setIsLoading","messagesEndRef","_messagesEndRef$curre","current","scrollIntoView","behavior","handleSend","trim","question","prev","type","content","loading","post","response","newMessages","length","data","answer","error","style","padding","height","display","flexDirection","children","Title","level","flex","overflowY","marginBottom","paddingRight","map","msg","index","alignItems","border","borderRadius","backgroundColor","width","maxWidth","size","color","marginLeft","ref","gap","value","onChange","e","target","onPressEnter","placeholder","disabled","onClick","fontSize","cursor","transform","transition","onMouseEnter","currentTarget","onMouseLeave"],"sources":["C:/Users/Home/Desktop/llama-qa/frontend/src/components/qaPage.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { Input, Typography, Spin, message } from 'antd';\r\nimport { UserOutlined, RobotOutlined, SendOutlined } from '@ant-design/icons';\r\nimport axios from 'axios';\r\n\r\nconst { Text } = Typography;\r\n\r\ninterface Message {\r\n  type: 'question' | 'answer';\r\n  content: string;\r\n  loading?: boolean;\r\n}\r\n\r\nconst QAPage: React.FC = () => {\r\n  const [inputValue, setInputValue] = useState('');\r\n  const [messages, setMessages] = useState<Message[]>([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Auto-scroll to bottom when messages change\r\n  useEffect(() => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }, [messages]);\r\n\r\n  const handleSend = async () => {\r\n    if (!inputValue.trim() || isLoading) return;\r\n\r\n    const question = inputValue;\r\n    setInputValue('');\r\n    \r\n    // Add user question\r\n    setMessages(prev => [\r\n      ...prev,\r\n      { type: 'question', content: question },\r\n      { type: 'answer', content: '', loading: true }\r\n    ]);\r\n\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      // 1. First ensure documents are indexed\r\n      await axios.post('http://localhost:8000/index');\r\n      \r\n      // 2. Get answer from FastAPI backend\r\n      const response = await axios.post('http://localhost:8000/ask', {\r\n        question: question\r\n      });\r\n\r\n      // Update the last message with the actual answer\r\n      setMessages(prev => {\r\n        const newMessages = [...prev];\r\n        newMessages[newMessages.length - 1] = {\r\n          type: 'answer',\r\n          content: response.data.answer || \"Sorry, I couldn't find an answer.\",\r\n          loading: false\r\n        };\r\n        return newMessages;\r\n      });\r\n    } catch (error) {\r\n      message.error('Failed to get answer');\r\n      setMessages(prev => {\r\n        const newMessages = [...prev];\r\n        newMessages[newMessages.length - 1] = {\r\n          type: 'answer',\r\n          content: \"Error: Couldn't connect to the AI service\",\r\n          loading: false\r\n        };\r\n        return newMessages;\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: '24px', height: '100%', display: 'flex', flexDirection: 'column' }}>\r\n      <Typography.Title level={3}>üêú Chat with Document</Typography.Title>\r\n\r\n      <div style={{ flex: 1, overflowY: 'auto', marginBottom: '16px', paddingRight: '8px' }}>\r\n        {messages.map((msg, index) => (\r\n          <div\r\n            key={index}\r\n            style={{\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              alignItems: msg.type === 'question' ? 'flex-start' : 'flex-start',\r\n              marginBottom: 16,\r\n            }}\r\n          >\r\n            <div\r\n              style={{\r\n                border: '1px solid #d9d9d9',\r\n                borderRadius: 8,\r\n                padding: '12px 16px',\r\n                backgroundColor: msg.type === 'question' ? '#f5f5f5' : '#e6f7ff',\r\n                width: 'fit-content',\r\n                maxWidth: '80%',\r\n              }}\r\n            >\r\n              {msg.loading ? (\r\n                <Spin size=\"small\" />\r\n              ) : (\r\n                <Text>\r\n                  {msg.type === 'question' ? (\r\n                    <UserOutlined style={{ color: '#1890ff' }} />\r\n                  ) : (\r\n                    <RobotOutlined style={{ color: '#52c41a' }} />\r\n                  )}\r\n                  <span style={{ marginLeft: 8 }}>{msg.content}</span>\r\n                </Text>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ))}\r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n\r\n      <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n        <Input\r\n          value={inputValue}\r\n          onChange={e => setInputValue(e.target.value)}\r\n          onPressEnter={handleSend}\r\n          placeholder=\"Ask a question about your documents...\"\r\n          disabled={isLoading}\r\n          style={{ flex: 1 }}\r\n        />\r\n        <SendOutlined\r\n          onClick={handleSend}\r\n          style={{\r\n            fontSize: 22,\r\n            color: isLoading ? '#d9d9d9' : '#1890ff',\r\n            cursor: isLoading ? 'not-allowed' : 'pointer',\r\n            transform: 'rotate(-45deg)',\r\n            transition: 'all 0.2s',\r\n          }}\r\n          onMouseEnter={e => !isLoading && (e.currentTarget.style.transform = 'scale(1.2) rotate(-45deg)')}\r\n          onMouseLeave={e => e.currentTarget.style.transform = 'rotate(-45deg)'}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default QAPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}